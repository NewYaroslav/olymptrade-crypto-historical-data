# Программы для работы с файлами котировок

## xqhtools

*xqhtools* - консольная программа для конвертации и слияния файлов котировок.

Данная программа собрана при помощи компилятора *MinGW-w64* версии *7.3.0* [https://sourceforge.net/projects/mingw-w64/](https://sourceforge.net/projects/mingw-w64/)
Если на вашем компьютере нет необходимых *dll* файлов, их можно взять из архива с компилятором или извлечь из архива *dll.7z*.

Исходные файлы программы можно найти [тут](https://github.com/NewYaroslav/xquotes_history).

### Быстрое использование

Для преобразования файлов *qhs5* в *csv-файлы* нужного вам часового пояса выберите один из двух *bat-файлов*: *build-mt4-msk-csv.bat* или *build-mt4-utc-csv.bat*.
Дождитесь окончания работы программы, после чего в папке *csv* появятся все файлы всех валютных пар.

### Подробное описание возможностей xqhtools

Команды:

* *train* - обучить алгоритм сжатия zstd на конкретном наборе данных. Данная команда необходима для создания словаря.
* *merge* - (Не реализовано полностью) слить файлы котировок или файлы каких либо данных вместе. Пока данная команда работает только с хранилищем Storage и может суммировать подфайлы.
* *convert_csv* - конвертировать csv файлы. Данная команда подходит для конвертации csv файлов в набор hex файлов или в хранилище котировок qhs*
* *convert_storage* - конвертировать qhs* файлы. Данная команда конвертирует файлы qhs* в csv файлы
* *date* - узнать минимальную и максимальную дату котировок файла хранилища
* *version* - версия программы

Переменные:

* *path_hex* - путь к папке с файлами hex
* *path_csv* - путь к файлу котировок в формате csv
* *path_storage* - путь к файлу котировок в формате хранилища котировок qhs*
* *header* - заголовок csv файла (переменная нужна только для преобразования qhs* файлов в csv)
* *path_dictionary* - путь к файлу словаря. Директория должна существовать! (переменная нужна только для команды train)
* *dictionary_name* - имя словаря (переменная нужна только для команды train)
* *path_raw_storage* - путь к хранилищу с данными для обучения алгоритма сжатия (переменная нужна только для команды train)
* *path_raw* - путь к файлам-образцам для обучения алгоритма сжатия (переменная нужна только для команды train)
* *fill_factor* - уровень заполнения от 1 до 100. Переменная нужна для уменьшения количества образцов из выборки для обучения алгоритма сжатия (переменная нужна только для команды train)
* *dictionary_capacity* - размер словарья, по умолчанию 102400 (переменная нужна только для команды train)
* *paths_raw_storages* - файлы хранилищ с данными, колторые нужно слить в одно хранилище (переменная нужна только для команды merge) 
* *path_out_raw_storage* - файл хранилища, куда будут помещены все подфайлы во время слияния (переменная нужна только для команды merge) 

Флаги:

* *-cetgmt* - преобразовать время CET в GMT
* *-eetgmt* - преобразовать время EET в GMT
* *-mskgmt* - преобразовать время MSK в GMT
* *-gmtcet* - преобразовать время GMT в CET
* *-gmteet* - преобразовать время GMT в EET
* *-gmtmsk* - преобразовать время GMT в MSK
* *-finam* - преобразовать время CET в GMT при конвертировании csv файлов 
* *-alpari* - преобразовать время EET в GMT или CET в GMT при конвертировании csv файлов (у ДЦ серверов Альпари с 01.05.2011 года время сервера поменялось с CET на EET)
* *-h* - прочитать заголовок csv файла. Не оказывает влияния
* *-oo* - использовать только цену открытия (open) бара или свечи. 
* *-oc* - использовать только цену закрытия (close) бара или свечи. 
* *-ohlc* - использовать 4 цены бара или свечи (open, high, low, close)
* *-ohlcv* - использовать 4 цены бара или свечи (open, high, low, close) и объем (volume)
* *-c* - использовать сжатие данных (только для преобразования csv в формат хранилища котировок qhs* или для слияния qhs* файлов)
* *-m4* - использовать преобразование qhs* файлов в csv формат для MetaTrader4
* *-m5* - использовать преобразование qhs* файлов в csv формат для MetaTrader5
* *-ducascopy* - использовать преобразование qhs* файлов в csv формат брокера Ducascopy
* *-sbc* - пропускать "плохие" бары во время преобразования qhs* файлов в csv. Плохие бары, это когда отсутствует цена за данную минуту
* *-fbc* - заполнять "плохие" бары во время преобразования qhs* файлов в csv. Заполнение будет происходить последней известной ценой
* *-wbc* - записывать "плохие" бары во время преобразования qhs* файлов в csv
* *-rnd* - перемешать в случайном порядке образцы для обучения алгоритма сжатия (флаг нужен только для команды train)
* *-cpp* - сохранить словарь в виде С++ заголовка (флаг нужен только для команды train)

### Пример использования

Преобразовать csv файл в qhs4 файл с использованием сжатия (флаг *-c*) и преобразованием времени из CET в GMT (флаг *-ohlc*):

```
xqhtools convert_csv path_storage ..\storage\AUDCAD path_csv ..\csv\AUDCAD1.csv -cetgmt -ohlc -c
```

Преобразовать qhs4 файл обратно в csv файл для MetaTrader4 с преобразованием GMT времени в CET (флаг *-gmtcet*) и пропуском плохих баров (*-sbc*)

```
xqhtools convert_storage path_storage ..\storage\AUDCAD.qhs4 path_csv ..\csv\AUDCAD1.csv -gmtcet -m4 -sbc
```

## Программа iolymp-trade-downloader

Данная программа скачивает котировки брокера [olymptrade](https://olymptrade.com/).

### Особенности использования

* Программа скачивает данные непосредственно с брокера через браузерное расширение
* Программа может скачивать только цену *(bid+ask)/2*.
* Программа скачивает данные в специальный формат [qhs4](https://github.com/NewYaroslav/xquotes_history). Данный формат использует библиотека [xquotes_history](https://github.com/NewYaroslav/xquotes_history). 
Формат содержит все цены бара (open, high, low, close). Преобразовать данный формат в файл *csv* можно при помощи специальной утилиты [xqhtools](https://github.com/NewYaroslav/xquotes_history/tree/master/bin).
* Настройки программы можно задать как через аргументы, так и через json файл.
* Программа может скачать котировки всех валютных пар, которые есть у брокера [olymptrade](https://olymptrade.com/).

### Быстрое использование

Активируйте режим разработчика в браузере Chrome. Подключите расширение *olymp-trade-bridge* в браузер, настройте порт (по умолчанию он равен 8080). Запустите *bat-файл* *run.bat*, после чего дожтиесь завершения работы программы. По умолчанию программа скачает все доступные данные.

### Параметры программы

/path_store | --path_store | /ps | -ps

Директория, где будут располагаться файлы исторических данных

/use_day_off | --use_day_off | /skip_day_off | --skip_day_off | /sdo | -sdo

Флаг, установка которого включает или отключает пропуск выходных дней (по UTC времени)

/use_current_day | --use_current_day | /skip_current_day | --skip_current_day | /scd | -scd

Флаг, установка которого включает или отключает пропуск текущего дня (по UTC времени).
Это может пригодиться, если нужно скачать полные дни.

/path_json_file | --path_json_file | /pjf | -pjf

Путь к файлу json с настройками

/port | /p
Порт сервера

/add_symbol | ask
Список символов (валютных пар), перечислить через запятую.

### Пример командной строки

```
olymp-trade-downloader-10.exe /port 8080 /path_store "..//storage" /use_day_off /use_current_day /add_symbol "ALTCOIN,ETHUSD,LTCUSD,DASHUSD,ETCUSD,LTCBTC,XRPUSD,Bitcoin,ZECUSD,ETHBTC"

```


